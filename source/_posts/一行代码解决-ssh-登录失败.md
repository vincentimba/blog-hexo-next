---
title: 一行命令解决 ssh 免密登录失败
categories: 
- IT 业余票友
- Linux
tags:
  - Linux
abbrlink: c8033c23
date: 2021-02-01 19:31:12
---
ssh 免密登录的问题一直困扰我了很久，总是时好时坏捉摸不定。即使在同一个服务器上也会出现不同用户有的可以登录，有的不能登录的问题。
<!--more-->
经过各种比对和尝试，怀疑是在复制公钥时出现了问题，因为自己一直使用手动复制再粘贴的方法来导入公钥。所以找到了这一行命令，让系统自己来导入公钥文件。

```
cat ~/.ssh/id_*.pub | ssh  user@host 'cat >> .ssh/authorized_keys'
```
实测之后，问题完美解决。

当然，也要保证除用户根目录`/home/user`、`~/.ssh`和`authorized_keys`这三个文件的权限分别为`700`、`700`和`600`。

**更新**

后来的使用中也发现存在自己手动复制不全的问题。与代码复制的密钥相比，手动复制会少复制整个公钥的第一个字母。这极可能就是导致免密登录失败的原因。

![image-20210217185708327](https://squidzh-1304890557.cos.ap-nanjing.myqcloud.com/blog_pic_bed/20210217185712.png)